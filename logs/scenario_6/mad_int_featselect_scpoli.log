WARNING:root:In order to use the mouse gastrulation seqFISH datsets, please install squidpy (see https://github.com/scverse/squidpy).
WARNING:root:In order to use sagenet models, please install pytorch geometric (see https://pytorch-geometric.readthedocs.io) and 
 captum (see https://github.com/pytorch/captum).
WARNING:root:mvTCR is not installed. To use mvTCR models, please install it first using "pip install mvtcr"
WARNING:root:multigrate is not installed. To use multigrate models, please install it first using "pip install multigrate".
INFO:scarches.trainers.scpoli.trainer:GPU available: True, GPU used: True
Embedding dictionary:
 	Num conditions: [2, 23]
 	Embedding dim: [5, 5]
Encoder Architecture:
	Input Layer in, out and cond: 1014 128 10
	Mean/Var Layer in/out: 128 30
Decoder Architecture:
	First Layer in, out and cond:  30 128 10
	Output Layer in/out:  128 1014 

Initializing dataloaders
Starting training
 |--------------------| 0.0%  - val_loss:  821.54 - val_cvae_loss:  821.54 |--------------------| 0.0%  - val_loss:  743.92 - val_cvae_loss:  743.92 |--------------------| 0.0%  - val_loss:  720.44 - val_cvae_loss:  720.44 |--------------------| 0.0%  - val_loss:  726.85 - val_cvae_loss:  726.85 |--------------------| 0.0%  - val_loss:  657.72 - val_cvae_loss:  657.72 |--------------------| 0.0%  - val_loss:  650.46 - val_cvae_loss:  650.46 |--------------------| 0.0%  - val_loss:  669.04 - val_cvae_loss:  669.04 |--------------------| 0.0%  - val_loss:  637.21 - val_cvae_loss:  637.21 |--------------------| 0.0%  - val_loss: 1267.99 - val_cvae_loss: 1267.99 |--------------------| 0.0%  - val_loss:  660.10 - val_cvae_loss:  660.10 |--------------------| 0.0%  - val_loss:  714.99 - val_cvae_loss:  714.99 |--------------------| 0.0%  - val_loss:  629.97 - val_cvae_loss:  629.97 |--------------------| 0.0%  - val_loss:  664.89 - val_cvae_loss:  664.89 |--------------------| 0.0%  - val_loss:  697.05 - val_cvae_loss:  697.05 |--------------------| 0.0%  - val_loss:  679.25 - val_cvae_loss:  679.25 |--------------------| 0.0%  - val_loss:  627.64 - val_cvae_loss:  627.64 |--------------------| 0.0%  - val_loss:  641.95 - val_cvae_loss:  641.95 |--------------------| 0.0%  - val_loss:  614.43 - val_cvae_loss:  614.43 |--------------------| 0.0%  - val_loss:  668.90 - val_cvae_loss:  668.90 |--------------------| 0.0%  - val_loss:  639.07 - val_cvae_loss:  639.07 |--------------------| 0.0%  - val_loss:  624.14 - val_cvae_loss:  624.14 |--------------------| 0.0%  - val_loss:  615.93 - val_cvae_loss:  615.93 |--------------------| 0.0%  - val_loss:  631.97 - val_cvae_loss:  631.97 |--------------------| 0.0%  - val_loss:  612.68 - val_cvae_loss:  612.68 |--------------------| 0.0%  - val_loss:  639.61 - val_cvae_loss:  639.61 |--------------------| 0.0%  - val_loss:  695.07 - val_cvae_loss:  624.58 - val_prototype_loss:   70.48 - val_labeled_loss:  140.97 |--------------------| 0.0%  - val_loss:  682.30 - val_cvae_loss:  634.84 - val_prototype_loss:   47.46 - val_labeled_loss:   94.92 |--------------------| 0.0%  - val_loss:  729.08 - val_cvae_loss:  691.96 - val_prototype_loss:   37.12 - val_labeled_loss:   74.24 |--------------------| 0.0%  - val_loss:  719.54 - val_cvae_loss:  689.31 - val_prototype_loss:   30.24 - val_labeled_loss:   60.47 |--------------------| 0.0%  - val_loss:  696.67 - val_cvae_loss:  670.17 - val_prototype_loss:   26.49 - val_labeled_loss:   52.99 |--------------------| 0.0%  - val_loss:  650.47 - val_cvae_loss:  626.65 - val_prototype_loss:   23.82 - val_labeled_loss:   47.63 |--------------------| 0.0%  - val_loss:  654.47 - val_cvae_loss:  632.08 - val_prototype_loss:   22.39 - val_labeled_loss:   44.79 |--------------------| 0.0%  - val_loss:  639.94 - val_cvae_loss:  620.01 - val_prototype_loss:   19.93 - val_labeled_loss:   39.86 |--------------------| 0.0%  - val_loss:  654.82 - val_cvae_loss:  635.20 - val_prototype_loss:   19.62 - val_labeled_loss:   39.25 |--------------------| 0.0%  - val_loss:  691.40 - val_cvae_loss:  672.55 - val_prototype_loss:   18.85 - val_labeled_loss:   37.70 |--------------------| 0.0%  - val_loss:  634.87 - val_cvae_loss:  616.71 - val_prototype_loss:   18.15 - val_labeled_loss:   36.30 |--------------------| 0.0%  - val_loss:  689.71 - val_cvae_loss:  672.29 - val_prototype_loss:   17.42 - val_labeled_loss:   34.84 |--------------------| 0.0%  - val_loss:  650.62 - val_cvae_loss:  633.45 - val_prototype_loss:   17.17 - val_labeled_loss:   34.35 |--------------------| 0.0%  - val_loss:  641.99 - val_cvae_loss:  625.28 - val_prototype_loss:   16.71 - val_labeled_loss:   33.42 |--------------------| 0.0%  - val_loss:  879.82 - val_cvae_loss:  863.52 - val_prototype_loss:   16.30 - val_labeled_loss:   32.61 |--------------------| 0.0%  - val_loss:  652.48 - val_cvae_loss:  636.76 - val_prototype_loss:   15.72 - val_labeled_loss:   31.44 |--------------------| 0.0%  - val_loss:  650.72 - val_cvae_loss:  634.95 - val_prototype_loss:   15.77 - val_labeled_loss:   31.54 |--------------------| 0.0%  - val_loss:  637.92 - val_cvae_loss:  622.23 - val_prototype_loss:   15.69 - val_labeled_loss:   31.38 |--------------------| 0.0%  - val_loss:  634.01 - val_cvae_loss:  618.72 - val_prototype_loss:   15.28 - val_labeled_loss:   30.56 |--------------------| 0.0%  - val_loss:  647.46 - val_cvae_loss:  632.43 - val_prototype_loss:   15.03 - val_labeled_loss:   30.06 |--------------------| 0.0%  - val_loss:  631.51 - val_cvae_loss:  616.53 - val_prototype_loss:   14.97 - val_labeled_loss:   29.95 |--------------------| 0.0%  - val_loss:  698.34 - val_cvae_loss:  683.05 - val_prototype_loss:   15.29 - val_labeled_loss:   30.58 |--------------------| 0.0%  - val_loss:  636.35 - val_cvae_loss:  621.37 - val_prototype_loss:   14.98 - val_labeled_loss:   29.96 |--------------------| 0.0%  - val_loss:  628.78 - val_cvae_loss:  613.71 - val_prototype_loss:   15.08 - val_labeled_loss:   30.15 |--------------------| 0.0%  - val_loss:  637.65 - val_cvae_loss:  623.36 - val_prototype_loss:   14.30 - val_labeled_loss:   28.60 |--------------------| 0.0%  - val_loss:  656.31 - val_cvae_loss:  641.88 - val_prototype_loss:   14.42 - val_labeled_loss:   28.84 |--------------------| 0.0%  - val_loss:  633.14 - val_cvae_loss:  618.93 - val_prototype_loss:   14.21 - val_labeled_loss:   28.41 |--------------------| 0.0%  - val_loss:  634.53 - val_cvae_loss:  620.30 - val_prototype_loss:   14.23 - val_labeled_loss:   28.45 |--------------------| 0.0%  - val_loss:  643.92 - val_cvae_loss:  629.61 - val_prototype_loss:   14.31 - val_labeled_loss:   28.62 |--------------------| 0.0%  - val_loss:  642.29 - val_cvae_loss:  628.35 - val_prototype_loss:   13.94 - val_labeled_loss:   27.88 |--------------------| 0.0%  - val_loss:  640.45 - val_cvae_loss:  626.43 - val_prototype_loss:   14.02 - val_labeled_loss:   28.05 |--------------------| 0.0%  - val_loss:  745.39 - val_cvae_loss:  731.30 - val_prototype_loss:   14.09 - val_labeled_loss:   28.19 |--------------------| 0.0%  - val_loss:  647.67 - val_cvae_loss:  634.03 - val_prototype_loss:   13.65 - val_labeled_loss:   27.30 |--------------------| 0.0%  - val_loss:  703.79 - val_cvae_loss:  689.89 - val_prototype_loss:   13.90 - val_labeled_loss:   27.81 |--------------------| 0.0%  - val_loss:  633.28 - val_cvae_loss:  619.42 - val_prototype_loss:   13.86 - val_labeled_loss:   27.72 |--------------------| 0.0%  - val_loss:  742.10 - val_cvae_loss:  728.37 - val_prototype_loss:   13.73 - val_labeled_loss:   27.46 |--------------------| 0.0%  - val_loss:  639.39 - val_cvae_loss:  625.52 - val_prototype_loss:   13.87 - val_labeled_loss:   27.75 |--------------------| 0.0%  - val_loss:  645.58 - val_cvae_loss:  631.96 - val_prototype_loss:   13.61 - val_labeled_loss:   27.23
ADJUSTED LR
 |--------------------| 0.0%  - val_loss:  634.77 - val_cvae_loss:  621.44 - val_prototype_loss:   13.33 - val_labeled_loss:   26.66 |--------------------| 0.0%  - val_loss:  625.11 - val_cvae_loss:  612.03 - val_prototype_loss:   13.08 - val_labeled_loss:   26.17 |--------------------| 0.0%  - val_loss:  655.85 - val_cvae_loss:  643.38 - val_prototype_loss:   12.47 - val_labeled_loss:   24.95 |--------------------| 0.0%  - val_loss:  630.47 - val_cvae_loss:  617.85 - val_prototype_loss:   12.62 - val_labeled_loss:   25.23 |--------------------| 0.0%  - val_loss:  724.60 - val_cvae_loss:  712.48 - val_prototype_loss:   12.12 - val_labeled_loss:   24.24 |--------------------| 0.0%  - val_loss:  636.37 - val_cvae_loss:  623.93 - val_prototype_loss:   12.44 - val_labeled_loss:   24.88 |--------------------| 0.0%  - val_loss:  636.06 - val_cvae_loss:  624.09 - val_prototype_loss:   11.97 - val_labeled_loss:   23.94 |--------------------| 0.0%  - val_loss:  635.95 - val_cvae_loss:  623.94 - val_prototype_loss:   12.01 - val_labeled_loss:   24.03 |--------------------| 0.0%  - val_loss:  635.01 - val_cvae_loss:  623.01 - val_prototype_loss:   12.00 - val_labeled_loss:   24.00 |--------------------| 0.0%  - val_loss:  621.21 - val_cvae_loss:  609.51 - val_prototype_loss:   11.71 - val_labeled_loss:   23.42 |--------------------| 0.0%  - val_loss:  635.92 - val_cvae_loss:  624.05 - val_prototype_loss:   11.87 - val_labeled_loss:   23.73 |--------------------| 0.0%  - val_loss:  627.43 - val_cvae_loss:  615.83 - val_prototype_loss:   11.60 - val_labeled_loss:   23.21 |--------------------| 0.0%  - val_loss:  890.01 - val_cvae_loss:  878.49 - val_prototype_loss:   11.52 - val_labeled_loss:   23.05 |--------------------| 0.0%  - val_loss:  655.33 - val_cvae_loss:  643.83 - val_prototype_loss:   11.50 - val_labeled_loss:   23.01 |--------------------| 0.0%  - val_loss:  634.90 - val_cvae_loss:  623.48 - val_prototype_loss:   11.42 - val_labeled_loss:   22.84 |--------------------| 0.0%  - val_loss:  706.12 - val_cvae_loss:  694.46 - val_prototype_loss:   11.65 - val_labeled_loss:   23.31 |--------------------| 0.0%  - val_loss:  632.38 - val_cvae_loss:  620.82 - val_prototype_loss:   11.56 - val_labeled_loss:   23.11 |--------------------| 0.0%  - val_loss:  640.24 - val_cvae_loss:  628.91 - val_prototype_loss:   11.33 - val_labeled_loss:   22.66 |--------------------| 0.0%  - val_loss:  697.95 - val_cvae_loss:  686.70 - val_prototype_loss:   11.25 - val_labeled_loss:   22.49 |--------------------| 0.0%  - val_loss:  638.03 - val_cvae_loss:  626.76 - val_prototype_loss:   11.28 - val_labeled_loss:   22.55 |--------------------| 0.0%  - val_loss:  676.54 - val_cvae_loss:  665.42 - val_prototype_loss:   11.11 - val_labeled_loss:   22.23 |--------------------| 0.0%  - val_loss:  634.20 - val_cvae_loss:  623.04 - val_prototype_loss:   11.16 - val_labeled_loss:   22.33 |--------------------| 0.0%  - val_loss:  631.88 - val_cvae_loss:  620.74 - val_prototype_loss:   11.14 - val_labeled_loss:   22.28 |--------------------| 0.0%  - val_loss:  689.71 - val_cvae_loss:  678.50 - val_prototype_loss:   11.20 - val_labeled_loss:   22.40
ADJUSTED LR
 |--------------------| 0.0%  - val_loss:  742.71 - val_cvae_loss:  731.54 - val_prototype_loss:   11.17 - val_labeled_loss:   22.34 |--------------------| 0.0%  - val_loss:  617.08 - val_cvae_loss:  605.80 - val_prototype_loss:   11.29 - val_labeled_loss:   22.57 |--------------------| 0.0%  - val_loss:  643.92 - val_cvae_loss:  632.92 - val_prototype_loss:   11.00 - val_labeled_loss:   22.00 |--------------------| 0.0%  - val_loss:  642.28 - val_cvae_loss:  631.15 - val_prototype_loss:   11.13 - val_labeled_loss:   22.27 |--------------------| 0.0%  - val_loss:  636.67 - val_cvae_loss:  625.70 - val_prototype_loss:   10.98 - val_labeled_loss:   21.96 |--------------------| 0.0%  - val_loss:  647.00 - val_cvae_loss:  635.78 - val_prototype_loss:   11.21 - val_labeled_loss:   22.42 |--------------------| 0.0%  - val_loss:  648.41 - val_cvae_loss:  637.26 - val_prototype_loss:   11.15 - val_labeled_loss:   22.30 |--------------------| 0.0%  - val_loss:  644.83 - val_cvae_loss:  633.70 - val_prototype_loss:   11.13 - val_labeled_loss:   22.26 |--------------------| 0.0%  - val_loss:  666.30 - val_cvae_loss:  655.17 - val_prototype_loss:   11.13 - val_labeled_loss:   22.26 |--------------------| 0.0%  - val_loss:  626.50 - val_cvae_loss:  615.62 - val_prototype_loss:   10.88 - val_labeled_loss:   21.75 |--------------------| 0.0%  - val_loss:  631.15 - val_cvae_loss:  620.06 - val_prototype_loss:   11.08 - val_labeled_loss:   22.17 |--------------------| 0.0%  - val_loss:  647.15 - val_cvae_loss:  636.06 - val_prototype_loss:   11.09 - val_labeled_loss:   22.17 |--------------------| 0.0%  - val_loss:  637.50 - val_cvae_loss:  626.35 - val_prototype_loss:   11.15 - val_labeled_loss:   22.31 |--------------------| 0.0%  - val_loss:  618.24 - val_cvae_loss:  607.17 - val_prototype_loss:   11.07 - val_labeled_loss:   22.14 |--------------------| 0.0%  - val_loss:  719.28 - val_cvae_loss:  708.22 - val_prototype_loss:   11.05 - val_labeled_loss:   22.11 |--------------------| 0.0%  - val_loss:  641.16 - val_cvae_loss:  629.87 - val_prototype_loss:   11.29 - val_labeled_loss:   22.58 |--------------------| 0.0%  - val_loss:  639.79 - val_cvae_loss:  629.03 - val_prototype_loss:   10.76 - val_labeled_loss:   21.52 |--------------------| 0.0%  - val_loss:  721.43 - val_cvae_loss:  710.25 - val_prototype_loss:   11.19 - val_labeled_loss:   22.37 |--------------------| 0.0%  - val_loss:  688.47 - val_cvae_loss:  677.43 - val_prototype_loss:   11.04 - val_labeled_loss:   22.08 |--------------------| 0.0%  - val_loss:  650.64 - val_cvae_loss:  639.54 - val_prototype_loss:   11.10 - val_labeled_loss:   22.20 |--------------------| 0.0%  - val_loss:  626.44 - val_cvae_loss:  615.26 - val_prototype_loss:   11.18 - val_labeled_loss:   22.36 |--------------------| 0.0%  - val_loss:  635.05 - val_cvae_loss:  624.16 - val_prototype_loss:   10.89 - val_labeled_loss:   21.77 |--------------------| 0.0%  - val_loss:  641.46 - val_cvae_loss:  630.38 - val_prototype_loss:   11.09 - val_labeled_loss:   22.17 |--------------------| 0.0%  - val_loss:  675.30 - val_cvae_loss:  664.40 - val_prototype_loss:   10.90 - val_labeled_loss:   21.80 |--------------------| 0.0%  - val_loss:  694.27 - val_cvae_loss:  683.46 - val_prototype_loss:   10.81 - val_labeled_loss:   21.63 |--------------------| 0.0%  - val_loss:  632.20 - val_cvae_loss:  621.44 - val_prototype_loss:   10.76 - val_labeled_loss:   21.52 |--------------------| 0.0%  - val_loss:  722.97 - val_cvae_loss:  712.08 - val_prototype_loss:   10.88 - val_labeled_loss:   21.77 |--------------------| 0.0%  - val_loss:  681.72 - val_cvae_loss:  670.85 - val_prototype_loss:   10.87 - val_labeled_loss:   21.74
ADJUSTED LR
 |--------------------| 0.0%  - val_loss:  641.63 - val_cvae_loss:  630.75 - val_prototype_loss:   10.88 - val_labeled_loss:   21.75 |--------------------| 0.0%  - val_loss:  650.21 - val_cvae_loss:  639.22 - val_prototype_loss:   10.99 - val_labeled_loss:   21.97 |--------------------| 0.0%  - val_loss:  821.04 - val_cvae_loss:  810.12 - val_prototype_loss:   10.92 - val_labeled_loss:   21.84 |--------------------| 0.0%  - val_loss:  640.67 - val_cvae_loss:  629.63 - val_prototype_loss:   11.04 - val_labeled_loss:   22.09 |--------------------| 0.0%  - val_loss:  659.23 - val_cvae_loss:  648.15 - val_prototype_loss:   11.08 - val_labeled_loss:   22.16 |--------------------| 0.0%  - val_loss:  645.90 - val_cvae_loss:  635.07 - val_prototype_loss:   10.83 - val_labeled_loss:   21.66 |--------------------| 0.0%  - val_loss:  741.89 - val_cvae_loss:  730.85 - val_prototype_loss:   11.04 - val_labeled_loss:   22.08/ictstr01/home/icb/mahima.arunkumar/hiwi/2023_Arevalo_BatchCorrection/env_store/b492bd78f19518491a238f5650087ab0_/lib/python3.9/site-packages/scarches/models/scpoli/scpoli_model.py:347: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at ../torch/csrc/utils/tensor_new.cpp:278.)
  c = torch.tensor(label_tensor, device=device).T

Stopping early: no improvement of more than 0 nats in 20 epochs
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
      Metadata_Source Metadata_Plate  ... Metadata_Column Metadata_Microscope
0            source_2     1053597936  ...              01              CV8000
1            source_2     1053597936  ...              22              CV8000
2            source_2     1053597936  ...              21              CV8000
3            source_2     1053597936  ...              20              CV8000
4            source_2     1053597936  ...              19              CV8000
...               ...            ...  ...             ...                 ...
11887        source_6   110000297122  ...              03              CV8000
11888        source_6   110000297122  ...              02              CV8000
11889        source_6   110000297122  ...              01              CV8000
11890        source_6   110000297122  ...              23              CV8000
11891        source_6   110000297122  ...              24              CV8000

[11892 rows x 13 columns] (11892, 30) ['scpoli_0', 'scpoli_1', 'scpoli_2', 'scpoli_3', 'scpoli_4', 'scpoli_5', 'scpoli_6', 'scpoli_7', 'scpoli_8', 'scpoli_9', 'scpoli_10', 'scpoli_11', 'scpoli_12', 'scpoli_13', 'scpoli_14', 'scpoli_15', 'scpoli_16', 'scpoli_17', 'scpoli_18', 'scpoli_19', 'scpoli_20', 'scpoli_21', 'scpoli_22', 'scpoli_23', 'scpoli_24', 'scpoli_25', 'scpoli_26', 'scpoli_27', 'scpoli_28', 'scpoli_29'] outputs/scenario_6/mad_int_featselect_scpoli.parquet
